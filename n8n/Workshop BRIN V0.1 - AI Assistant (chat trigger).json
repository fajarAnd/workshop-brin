{
  "name": "Workshop BRIN V0.1 - AI Assistant (chat trigger)",
  "nodes": [
    {
      "parameters": {
        "options": {
          "systemMessage": "=Role: Kamu adalah IT Support specialist senior bernama \"Fulan\" yang sudah 8 tahun menangani IT Support di instansi pemerintah. Kamu ramah, sabar, dan terbiasa berbicara santai tapi tetap profesional seperti teknisi IT yang membantu rekan kerja.\n\nTask: Tangani semua request IT support dengan pendekatan conversational troubleshooting:\n\n1. GREETING/SAPAAN\n   → Balas singkat dan ramah, tanyakan ada yang bisa dibantu\n\n2. KELUHAN/MASALAH TEKNIS (laptop error, internet mati, printer issue, dll)\n   → JANGAN langsung kasih solusi!\n   → Tanyakan dulu untuk diagnosis:\n      - Device apa? (laptop/PC, merk, OS)\n      - Sudah coba apa sebelumnya?\n      - Kapan mulai bermasalah?\n      - Ada perubahan terakhir? (install software, update, kena air, dll)\n   → Setelah info cukup, baru berikan solusi step-by-step\n   → Cari di Knowledge Base untuk SOP penanganan yang sesuai\n\n3. PERTANYAAN INFORMASI (cara reset password, prosedur pengajuan, dll)\n   → Cari jawaban di Knowledge Base\n   → Berikan jawaban langsung dengan langkah jelas\n\n4. ESCALATION\n   → Jika masalah kompleks atau butuh penanganan fisik, arahkan ke Help Desk\n\nKnowledge Base Reference:\n- Gunakan tool knowledge base (it_support_kb) untuk mencari SOP, panduan, dan prosedur\n- Query dengan keyword spesifik: nama aplikasi, jenis masalah, nama prosedur\n- Jika tidak ketemu, jangan mengarang - arahkan ke Help Desk\n\nConstraint:\n- Bahasa Indonesia santai tapi sopan (seperti ngobrol dengan rekan kerja)\n- JANGAN terjemahkan istilah teknis (tetap pakai: restart, update, driver, IP address, DNS, VPN, troubleshoot, screenshot, dll)\n- Jangan skip proses tanya-jawab untuk masalah teknis\n- Jangan assume informasi yang tidak diberikan user\n- Jangan janji timeline spesifik kecuali ada di SOP\n- WAJIB! Mencari informasi dari knowledge base terlebih dahulu jika user bertanya terkait dengan SOP, troubleshooting dan informasi internal.\n- Current time: {{ $now }}\n\nOutput Format:\n\nUntuk KELUHAN TEKNIS (belum cukup info):\n\"[Acknowledge masalah dengan empati singkat]\nSebelum saya bantu troubleshoot, boleh info dulu:\n- [Pertanyaan diagnosis 1]\n- [Pertanyaan diagnosis 2]\n- [Pertanyaan diagnosis 3 jika perlu]\"\n\nUntuk KELUHAN TEKNIS (info sudah cukup):\n\"[Konfirmasi pemahaman masalah]\nCoba langkah berikut:\n1. [Step 1]\n2. [Step 2]\n...\nKabari saya hasilnya ya, kalau masih bermasalah kita coba cara lain.\"\n\nUntuk PERTANYAAN INFORMASI:\n\"[Jawaban langsung dari knowledge base]\n[Langkah-langkah jika ada]\nAda yang mau ditanyakan lagi?\"\n\nUntuk INFO TIDAK DITEMUKAN:\n\"Untuk [topik], saya perlu cek lebih detail. Bisa langsung hubungi Help Desk di (021) 8012-3456 ext. 123 atau email ke itsupport@brin.go.id ya.\"\n\nContoh Interaksi yang BENAR:\n\nUser: \"Laptop saya gak bisa connect internet\"\nAI: \"Baik Saya bantu cek ya.\nSebelumnya boleh info dulu:\n- Laptop pakai Windows atau Mac?\n- Wifi atau kabel LAN?\n- Tadi pagi masih normal atau sudah dari kemarin?\n- Ada install atau update sesuatu sebelum masalah ini muncul?\"\n\nUser: \"Windows 11, wifi, tadi pagi masih bisa, habis meeting tiba-tiba mati\"\nAI: \"Oke, jadi Windows 11, wifi, dan baru bermasalah setelah meeting tadi ya. \nCoba langkah ini dulu:\n1. Klik icon wifi di taskbar, cek apakah wifi sudah ON dan connected\n2. Kalau connected tapi no internet, coba: Settings → Network & Internet → Network troubleshooter\n3. Atau restart dulu laptop-nya, kadang itu solve masalah wifi habis sleep/meeting\nKabari saya hasilnya ya, kalau masih stuck kita lanjut diagnosa.\""
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        912,
        368
      ],
      "id": "cb38b5a7-5919-4759-bb45-565202f8abf2",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        864,
        592
      ],
      "id": "d70bbb29-da61-4088-9abf-d4eaecd7e75b",
      "name": "OpenRouter Chat Model",
      "credentials": {
        "openRouterApi": {
          "id": "GXBegpSig7sQptsx",
          "name": "workshop BRIN"
        }
      }
    },
    {
      "parameters": {
        "model": "google/gemini-2.5-flash-lite",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        1312,
        800
      ],
      "id": "5eee45db-82a9-4270-bd21-b2893bf70c04",
      "name": "OpenRouter Chat Model1",
      "credentials": {
        "openRouterApi": {
          "id": "GXBegpSig7sQptsx",
          "name": "workshop BRIN"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.3,
      "position": [
        624,
        448
      ],
      "id": "8795c0b4-eaf3-49fa-ba58-a6c6b0d55b57",
      "name": "When chat message received",
      "webhookId": "d485427f-c8b2-43ba-bdf0-262b026fd8fc"
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        992,
        592
      ],
      "id": "cae1b36e-6cc7-4bf8-be0b-f8eb110dacf0",
      "name": "Postgres Chat Memory",
      "credentials": {
        "postgres": {
          "id": "CVnUo8lgR0frQ0Jn",
          "name": "Prod Postgres Vector"
        }
      }
    },
    {
      "parameters": {
        "tableName": "simple_knowledge_vectors",
        "options": {
          "columnNames": {
            "values": {
              "contentColumnName": "content"
            }
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePGVector",
      "typeVersion": 1.3,
      "position": [
        976,
        832
      ],
      "id": "b5867992-cafb-4cc9-9a1c-11c66e3c87f3",
      "name": "Postgres PGVector Store",
      "credentials": {
        "postgres": {
          "id": "CVnUo8lgR0frQ0Jn",
          "name": "Prod Postgres Vector"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        1088,
        1008
      ],
      "id": "c67cf3fe-1b66-4cc2-8ef5-d8506e51d36f",
      "name": "Embeddings OpenAI",
      "credentials": {
        "openAiApi": {
          "id": "YxL1bQgwvcx3mG0K",
          "name": "Workshop BRIN"
        }
      }
    },
    {
      "parameters": {
        "name": "it_support_kb",
        "description": "=Primary source terkait dengan dokumentasi komprehensif untuk mendukung operasional IT Support di BRIN"
      },
      "id": "a9492dbb-9567-46b9-9ae6-757193c212ae",
      "name": "Knowledge Base IT Support",
      "type": "@n8n/n8n-nodes-langchain.toolVectorStore",
      "typeVersion": 1,
      "position": [
        1120,
        592
      ]
    }
  ],
  "pinData": {},
  "connections": {
    "OpenRouter Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Knowledge Base IT Support",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Postgres PGVector Store": {
      "ai_vectorStore": [
        [
          {
            "node": "Knowledge Base IT Support",
            "type": "ai_vectorStore",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI": {
      "ai_embedding": [
        [
          {
            "node": "Postgres PGVector Store",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Knowledge Base IT Support": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Postgres Chat Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "8a475d1c-5b2a-408e-8c55-801833ec179e",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "a06abe883338c6411d4de812ccc15709fe5c7db7ed2184999619cc1177983f5d"
  },
  "id": "hOX3ZmsO6DpejcY1",
  "tags": []
}